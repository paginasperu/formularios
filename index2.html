<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Catálogo — Insumos Químicos (Demo)</title>

  <!-- Fuente + iconos simples -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#94a3b8;
      --accent:#06b6d4;
      --glass: rgba(255,255,255,0.04);
      --radius:14px;
      --max-width:1180px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,var(--bg),#071024 120%);
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      gap:20px;
      min-height:100vh;
    }

    .app{
      width:100%;
      max-width:var(--max-width);
    }

    header.app-header{
      display:flex;
      gap:18px;
      align-items:center;
      margin-bottom:20px;
    }
    .brand{
      background:linear-gradient(135deg,#02203a,#0b4b5b);
      padding:14px 18px;
      border-radius:12px;
      box-shadow:0 6px 30px rgba(3,16,28,0.6);
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo{
      width:48px;height:48px;border-radius:10px;
      display:grid;place-items:center;
      background:linear-gradient(180deg,#0ea5a8,#036d6f);
      font-weight:700;color:white;font-size:18px;
      box-shadow:0 4px 14px rgba(14,165,164,0.12);
    }
    .title {
      font-size:1.25rem;font-weight:700;
      line-height:1;
    }
    .subtitle{font-size:0.86rem;color:var(--muted);margin-top:3px}

    /* Controls area */
    .controls{
      margin-top:10px;
      display:flex;
      gap:16px;
      align-items:center;
      flex-wrap:wrap;
    }

    .search{
      flex:1 1 360px;
      display:flex;
      gap:10px;
      align-items:center;
      background:var(--glass);
      padding:10px;border-radius:12px;
      border:1px solid rgba(255,255,255,0.03);
      box-shadow:inset 0 -1px 0 rgba(255,255,255,0.02);
    }
    .search input{
      background:transparent;border:0;outline:none;color:inherit;font-size:0.95rem;width:100%;
    }
    .control-row{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .select, .btn, .chip {
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border:1px solid rgba(255,255,255,0.03);
      padding:8px 12px;border-radius:10px;color:var(--muted);
      font-size:0.9rem;
    }
    .select select{background:transparent;border:0;color:inherit;outline:none;font:inherit}

    .btn {
      cursor:pointer;color:#052431;background:linear-gradient(180deg,var(--accent),#028287);
      font-weight:700;border-radius:12px;padding:8px 12px;
      box-shadow:0 6px 20px rgba(6,182,212,0.14);
    }

    /* Layout */
    .main{
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:20px;
      align-items:start;
    }

    /* Sidebar filters */
    .filters{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      padding:18px;
      border:1px solid rgba(255,255,255,0.03);
      position:sticky; top:28px;
      height:fit-content;
    }
    .filters h4{margin:0 0 12px 0;font-size:0.98rem}
    .filter-group{margin-bottom:16px}
    .tags{display:flex;flex-wrap:wrap;gap:8px}
    .tag-btn{
      padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.03);
      background:transparent;font-size:0.85rem;color:var(--muted);cursor:pointer;
    }
    .tag-btn.active{
      background:linear-gradient(90deg,#063b45,#06b6d4);
      color:white;border:0;box-shadow:0 6px 16px rgba(3,20,23,0.5);
    }

    .range {
      display:flex;gap:10px;align-items:center;
    }
    .range input[type="range"]{width:100%;}
    .small{font-size:0.82rem;color:var(--muted)}

    /* Grid & cards */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
      gap:18px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);
      transition:transform .18s ease, box-shadow .18s ease;
      display:flex;flex-direction:column;
    }
    .card:hover{transform:translateY(-6px);box-shadow:0 12px 40px rgba(2,8,23,0.6)}
    .card .media{height:150px;background:#0b1320;display:block}
    .card img{width:100%;height:100%;object-fit:cover;display:block}
    .card .body{padding:12px 14px;display:flex;flex-direction:column;gap:8px}
    .tag-pill{display:inline-block;padding:6px 8px;border-radius:8px;font-size:0.78rem;color:var(--muted);background:rgba(255,255,255,0.02)}
    .name{font-weight:700;color:#cfeffd;font-size:0.98rem}
    .desc{font-size:0.86rem;color:var(--muted);line-height:1.2}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
    .price{font-weight:800;color:#bff3fb}
    .buy{
      margin-top:10px;padding:8px;border-radius:10px;border:0;background:transparent;color:var(--accent);font-weight:700;cursor:pointer;
    }

    /* Empty state */
    .empty{
      padding:28px;border-radius:12px;text-align:center;color:var(--muted);
      grid-column:1/-1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.01));
      border:1px dashed rgba(255,255,255,0.02);
    }

    /* utilities */
    .row{display:flex;gap:10px;align-items:center}
    .muted{color:var(--muted)}
    @media (max-width:980px){
      .main{grid-template-columns:1fr}
      .filters{position:static}
      .brand{padding:10px}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Catálogo de insumos químicos - demo">
    <header class="app-header" role="banner">
      <div class="brand" aria-hidden="false">
        <div class="logo">IQ</div>
        <div>
          <div class="title">Catálogo — Insumos Químicos</div>
          <div class="subtitle">Demo interactiva • Búsqueda, filtros y orden</div>
        </div>
      </div>
      <div style="flex:1"></div>
      <div class="control-row" aria-hidden="false">
        <div class="select" title="Ordenar">
          <label for="sort" class="muted" style="font-size:0.78rem;margin-right:8px">Ordenar</label>
          <select id="sort" aria-label="Ordenar productos">
            <option value="featured">Destacados</option>
            <option value="price-asc">Precio: menor → mayor</option>
            <option value="price-desc">Precio: mayor → menor</option>
            <option value="name-asc">Nombre A → Z</option>
            <option value="name-desc">Nombre Z → A</option>
            <option value="stock-desc">Más stock</option>
          </select>
        </div>
      </div>
    </header>

    <div class="controls">
      <div class="search" role="search" aria-label="Buscar productos">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="rgba(255,255,255,0.6)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/><circle cx="11" cy="11" r="6" stroke="rgba(255,255,255,0.6)" stroke-width="1.5" fill="none"/></svg>
        <input id="search" placeholder="Buscar por nombre, aplicación, marca..." autocomplete="off" />
        <button id="clearSearch" class="btn" title="Limpiar búsqueda" style="display:none">Limpiar</button>
      </div>

      <div class="control-row">
        <div class="select" style="min-width:180px">
          <label class="muted" for="categoryFilter" style="font-size:0.78rem;margin-right:8px">Categoría</label>
          <select id="categoryFilter" aria-label="Filtrar por categoría">
            <option value="all">Todas</option>
            <option value="reactive">Reactivos</option>
            <option value="lab">Laboratorio</option>
            <option value="industrial">Industrial</option>
            <option value="water">Tratamiento de agua</option>
            <option value="solids">Sólidos</option>
          </select>
        </div>
        <div class="select" style="display:flex;align-items:center">
          <label class="muted" for="availability" style="font-size:0.78rem;margin-right:8px">Disponibles</label>
          <input type="checkbox" id="availability" aria-label="Mostrar solo productos en stock"/>
        </div>
        <div><button id="resetFilters" class="btn" title="Restablecer filtros">Restablecer</button></div>
      </div>
    </div>

    <main class="main" role="main">
      <aside class="filters" aria-label="Filtros">
        <h4>Filtros rápidos</h4>

        <div class="filter-group">
          <div class="small">Etiquetas</div>
          <div class="tags" id="tagsContainer" role="list">
            <!-- chips dinámicos -->
          </div>
        </div>

        <div class="filter-group">
          <div class="small">Rango de precio (S/)</div>
          <div class="range">
            <input type="range" id="priceRange" min="0" max="500" step="1" value="500" />
            <div class="small" id="priceValue">Hasta S/ 500</div>
          </div>
        </div>

        <div class="filter-group">
          <div class="small">Buscar por aplicación</div>
          <input id="appFilter" class="select" placeholder="ej. desinfección, coagulante" />
        </div>

        <div class="filter-group">
          <div class="small">Orden actual</div>
          <div class="muted" id="currentSort">Destacados</div>
        </div>

        <div style="border-top:1px solid rgba(255,255,255,0.03);margin-top:12px;padding-top:12px">
          <div class="small">Sugerencia</div>
          <div class="muted" style="margin-top:8px">Las imágenes son aleatorias (loremflickr). Para producción, hospeda tus imágenes en tu CDN.</div>
        </div>
      </aside>

      <section style="display:flex;flex-direction:column;gap:12px">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div class="muted" id="resultsInfo">Mostrando 0 productos</div>
          <div class="row small muted">Demo • datos simulados • imágenes: loremflickr.com</div>
        </div>

        <div id="grid" class="grid" aria-live="polite" aria-busy="false">
          <!-- tarjetas -->
        </div>
      </section>
    </main>
  </div>

  <script>
    /* ---------------------------
       Datos simulados (catalogo)
       --------------------------- */
    const PRODUCTS = [
      { id:1, name:"Ácido Clorhídrico 37%", tag:"reactive", price:48.00, stock:24, apps:["limpieza","tratamiento"], desc:"Reactivo para procesos industriales y limpieza profunda." },
      { id:2, name:"Alcohol Isopropílico 99%", tag:"lab", price:32.50, stock:120, apps:["desinfección","limpieza electrónica"], desc:"Alcohol de alta pureza para limpieza y desinfección." },
      { id:3, name:"Sulfato de Aluminio", tag:"water", price:20.00, stock:60, apps:["coagulación","potabilización"], desc:"Coagulante para tratamiento de agua." },
      { id:4, name:"Peróxido de Hidrógeno 50%", tag:"industrial", price:75.00, stock:8, apps:["oxidación","blanqueo"], desc:"Agente oxidante para procesos industriales." },
      { id:5, name:"Soda Cáustica (Escamas)", tag:"solids", price:28.00, stock:40, apps:["fabricación jabones","limpieza"], desc:"Hidróxido de sodio en escamas para procesos industriales." },
      { id:6, name:"Ácido Cítrico Anhidro", tag:"solids", price:18.00, stock:200, apps:["alimentario","limpieza"], desc:"Aditivo alimentario y agente limpiador biodegradable." },
      { id:7, name:"Cloro Líquido 10%", tag:"industrial", price:12.50, stock:320, apps:["desinfección","piscinas"], desc:"Solución clorada para desinfección general." },
      { id:8, name:"Tensoactivo Aniónico", tag:"industrial", price:58.00, stock:14, apps:["detergentes","formulación"], desc:"Base para detergentes y formulaciones de limpieza." },
      { id:9, name:"Borato de Sodio", tag:"reactive", price:22.00, stock:76, apps:["conservante","formulaciones"], desc:"Usado en formulaciones y aplicaciones industriales." },
      { id:10, name:"Nitrato de Amonio (pequeño)", tag:"reactive", price:44.00, stock:6, apps:["fertilizante"], desc:"Usado principalmente en agricultura y formulaciones." },
      { id:11, name:"Indicador pH Universal", tag:"lab", price:9.50, stock:140, apps:["medición","laboratorio"], desc:"Tiras e indicadores para medición de pH." },
      { id:12, name:"Cloruro de Sodio Industrial", tag:"solids", price:7.80, stock:500, apps:["procesos","sector alimentario"], desc:"Sal industrial de calidad para procesos diversos." }
    ];

    /* ---------------------------
       Estado UI
       --------------------------- */
    const state = {
      q: '',
      category: 'all',
      tags: new Set(),
      maxPrice: 500,
      onlyAvailable: false,
      appFilter: '',
      sort: 'featured'
    };

    /* ---------------------------
       DOM refs
       --------------------------- */
    const grid = document.getElementById('grid');
    const searchEl = document.getElementById('search');
    const clearSearchBtn = document.getElementById('clearSearch');
    const categoryFilter = document.getElementById('categoryFilter');
    const availability = document.getElementById('availability');
    const priceRange = document.getElementById('priceRange');
    const priceValue = document.getElementById('priceValue');
    const tagsContainer = document.getElementById('tagsContainer');
    const appFilter = document.getElementById('appFilter');
    const sortSelect = document.getElementById('sort');
    const resultsInfo = document.getElementById('resultsInfo');
    const resetFilters = document.getElementById('resetFilters');
    const currentSort = document.getElementById('currentSort');

    /* ---------------------------
       Helpers
       --------------------------- */
    function debounce(fn, wait=220){
      let t;
      return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), wait) }
    }

    function formatPrice(v){ return 'S/ ' + v.toFixed(2) }

    function getImageUrl(idKeywords){
      // use loremflickr with keywords related to chemistry / lab / industry
      // add random param to avoid repeats when needed
      const kw = encodeURIComponent(idKeywords);
      const rnd = Math.floor(Math.random()*9999);
      return `https://loremflickr.com/640/360/${kw}?random=${rnd}`;
    }

    /* ---------------------------
       Render functions
       --------------------------- */
    function makeTagButton(label, key){
      const btn = document.createElement('button');
      btn.className = 'tag-btn';
      btn.type = 'button';
      btn.textContent = label;
      btn.dataset.key = key;
      btn.addEventListener('click',()=> {
        if(state.tags.has(key)){ state.tags.delete(key); btn.classList.remove('active') }
        else { state.tags.add(key); btn.classList.add('active') }
        render();
      });
      return btn;
    }

    function renderTags(){
      const availableTags = Array.from(new Set(PRODUCTS.map(p=>p.tag)));
      tagsContainer.innerHTML = '';
      availableTags.forEach(t => {
        const label = (t==='reactive')? 'Reactivos' : (t==='lab')? 'Laboratorio' : (t==='industrial')? 'Industrial' : (t==='water')? 'Tratamiento agua' : (t==='solids')? 'Sólidos' : t;
        const btn = makeTagButton(label, t);
        tagsContainer.appendChild(btn);
      });
    }

    function applyFilters(products){
      const q = state.q.trim().toLowerCase();
      return products.filter(p=>{
        if(state.category !== 'all' && p.tag !== state.category) return false;
        if(state.onlyAvailable && (!p.stock || p.stock <= 0)) return false;
        if(p.price > state.maxPrice) return false;
        if(state.tags.size > 0 && !state.tags.has(p.tag)) return false;
        if(state.appFilter.trim()){
          const a = state.appFilter.trim().toLowerCase();
          const found = p.apps.some(x=>x.toLowerCase().includes(a));
          if(!found) return false;
        }
        if(q){
          const inName = p.name.toLowerCase().includes(q);
          const inDesc = p.desc.toLowerCase().includes(q);
          const inApps = p.apps.join(' ').toLowerCase().includes(q);
          if(!(inName || inDesc || inApps)) return false;
        }
        return true;
      });
    }

    function applySort(products){
      const s = state.sort;
      currentSort.textContent = {
        'featured':'Destacados',
        'price-asc':'Precio: menor → mayor',
        'price-desc':'Precio: mayor → menor',
        'name-asc':'Nombre A → Z',
        'name-desc':'Nombre Z → A',
        'stock-desc':'Más stock'
      }[s] || 'Destacados';

      const arr = [...products];
      switch(s){
        case 'price-asc': arr.sort((a,b)=>a.price-b.price); break;
        case 'price-desc': arr.sort((a,b)=>b.price-a.price); break;
        case 'name-asc': arr.sort((a,b)=>a.name.localeCompare(b.name)); break;
        case 'name-desc': arr.sort((a,b)=>b.name.localeCompare(a.name)); break;
        case 'stock-desc': arr.sort((a,b)=>b.stock-b.stock); break;
        default: /* featured: show by stock desc then price asc */ arr.sort((a,b)=> (b.stock - a.stock) || (a.price - b.price) ); break;
      }
      return arr;
    }

    function renderCard(p){
      const el = document.createElement('article');
      el.className = 'card';
      el.setAttribute('data-id', p.id);
      el.innerHTML = `
        <div class="media" aria-hidden="true">
          <img loading="lazy" src="${getImageUrl(p.tag + ',lab,chemistry')}" alt="${p.name} - imagen relacionada" decoding="async"/>
        </div>
        <div class="body">
          <div class="tag-pill">${(p.tag==='reactive')? 'Reactivo' : (p.tag==='lab')? 'Laboratorio' : (p.tag==='industrial')? 'Industrial' : (p.tag==='water')? 'Tratamiento' : 'Sólido'}</div>
          <div class="name" title="${p.name}">${p.name}</div>
          <div class="desc">${p.desc}</div>
          <div class="meta">
            <div class="small muted">Stock: ${p.stock}</div>
            <div class="price">${formatPrice(p.price)}</div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <button class="buy" data-id="${p.id}" ${p.stock>0 ? '' : 'disabled'}>${p.stock>0? 'Agregar' : 'Agotado'}</button>
            <div class="small muted">${p.apps.join(' • ')}</div>
          </div>
        </div>
      `;
      // simple add-to-cart demo
      el.querySelector('.buy').addEventListener('click', e=>{
        const id = Number(e.currentTarget.dataset.id);
        const product = PRODUCTS.find(x=>x.id===id);
        if(!product) return;
        if(product.stock <= 0){ alert('Producto sin stock'); return; }
        product.stock = Math.max(0, product.stock - 1);
        e.currentTarget.textContent = product.stock>0 ? 'Agregar' : 'Agotado';
        render(); // re-render to update stock & ordering
      });
      return el;
    }

    function render(){
      grid.setAttribute('aria-busy','true');
      // compute
      let items = applyFilters(PRODUCTS);
      items = applySort(items);

      grid.innerHTML = '';
      if(items.length === 0){
        const emp = document.createElement('div');
        emp.className = 'empty';
        emp.innerHTML = `<strong>Sin resultados</strong><div style="margin-top:8px" class="muted">Prueba ajustar filtros o buscar con palabras distintas.</div>`;
        grid.appendChild(emp);
      } else {
        items.forEach(p=> grid.appendChild(renderCard(p)));
      }

      resultsInfo.textContent = `Mostrando ${items.length} producto${items.length!==1?'s':''} — Total catálogo: ${PRODUCTS.length}`;
      grid.setAttribute('aria-busy','false');
    }

    /* ---------------------------
       UI bindings
       --------------------------- */
    // initialize
    renderTags();
    render();

    // search with debounce
    const onSearch = debounce((val)=>{
      state.q = val;
      clearSearchBtn.style.display = val ? 'inline-block' : 'none';
      render();
    },220);

    searchEl.addEventListener('input', e=> onSearch(e.target.value));
    clearSearchBtn.addEventListener('click', ()=> {
      searchEl.value = ''; state.q=''; clearSearchBtn.style.display='none'; render();
    });

    categoryFilter.addEventListener('change', e=>{
      state.category = e.target.value;
      render();
    });

    availability.addEventListener('change', e=>{
      state.onlyAvailable = e.target.checked;
      render();
    });

    priceRange.addEventListener('input', e=>{
      state.maxPrice = Number(e.target.value);
      priceValue.textContent = `Hasta S/ ${state.maxPrice}`;
      render();
    });

    appFilter.addEventListener('input', debounce(e=>{
      state.appFilter = e.target.value;
      render();
    },220));

    sortSelect.addEventListener('change', e=>{
      state.sort = e.target.value;
      render();
    });

    resetFilters.addEventListener('click', ()=>{
      state.q = ''; searchEl.value='';
      state.category = 'all'; categoryFilter.value='all';
      state.tags.clear(); Array.from(document.querySelectorAll('.tag-btn')).forEach(b=>b.classList.remove('active'));
      state.maxPrice = 500; priceRange.value=500; priceValue.textContent = 'Hasta S/ 500';
      state.onlyAvailable = false; availability.checked=false;
      state.appFilter = ''; appFilter.value='';
      state.sort = 'featured'; sortSelect.value='featured';
      clearSearchBtn.style.display='none';
      render();
    });

    // keyboard: press / to focus search
    window.addEventListener('keydown', e=>{
      if(e.key === '/' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA'){
        e.preventDefault(); searchEl.focus(); searchEl.select();
      }
    });

    // accessibility: announce total on load
    window.addEventListener('load', ()=> {
      const live = document.createElement('div');
      live.setAttribute('aria-live','polite');
      live.style.position='absolute'; live.style.left='-9999px';
      live.textContent = `Catálogo cargado. ${PRODUCTS.length} productos disponibles. Usa / para buscar rápido.`;
      document.body.appendChild(live);
    });
  </script>
</body>
</html>
